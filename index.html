<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png" />
    <link href="images/apple-touch-startup-image-320x460.png" media="(device-width: 320px)"
        rel="apple-touch-startup-image">
    <link href="images/apple-touch-startup-image-640x920.png"
        media="(device-width: 320px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
    <title>厦门大学图书法学与艺术分馆捐书系统</title>
    <link rel="stylesheet" href="css/framework7.css">
    <link rel="stylesheet" href="style.css">
    <link type="text/css" rel="stylesheet" href="css/swipebox.css" />
    <link type="text/css" rel="stylesheet" href="css/animations.css" />
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,900" rel="stylesheet">
</head>

<body id="mobile_wrap">



    <!-- Status bar overlay for full screen mode (PhoneGap) -->
    <div class="statusbar-overlay"></div>

    <div class="panel-overlay"></div>

    <div class="panel panel-left panel-reveal">
        <div class="view view-subnav">
            <div class="pages">
                <div data-page="panel-leftmenu" class="page pagepanel">
                    <div class="page-content">
                        <nav class="main_nav_icons_inline_2">
                            <ul>
                                <li><a href="./" class="close-panel" data-view=".view-main"><img
                                            src="images/icons/white/home.png" alt="" title="" /><span>首页</span></a></li>
                                <li><a href="borrow_book.html" class="close-panel" data-view=".view-main"><img
                                            src="images/icons/white/扫一扫.png" alt="" title="" /><span>扫一扫借书</span></a>
                                </li>
                                <li><a href="books_list.html" class="close-panel" data-view=".view-main"><img
                                            src="images/icons/white/list.png" alt="" title="" /><span>图书馆藏书</span></a>
                                </li>

                                <li><a href="books_donation.html" class="close-panel" data-view=".view-main"><img
                                            src="images/icons/white/书.png" alt="" title="" /><span>我要捐书</span></a></li>
                                <li><a href="return-book.html" class="close-panel" data-view=".view-main"><img
                                            src="images/icons/white/相机（1）.png" alt="" title="" /><span>拍照还书</span></a>
                                </li>
                                <li><a href="#" data-popup=".popup-loading" class="open-popup close-panel"><img src="images/icons/white/message.png" alt="" title="" />
<!--                                    <span class="superscript01">3</span>-->
                                    <span>交流区</span>
                                </a></li>

                                <!--<li><a href="#" data-popup=".popup-login" class="open-popup close-panel"><img src="images/icons/white/我的.png" alt="" title="" /><span>待定</span></a></li>-->
                                <!--<li><a href="#" data-popup=".popup-login" class="open-popup close-panel"><img src="images/icons/white/我的.png" alt="" title="" /><span>待定</span></a></li>-->
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="panel panel-right panel-reveal">
        <div class="user_login_info">
            <div v-if="g_data.isLogin">
                <div class="user_thumb">
                    <img src="images/我的背景.jpg" alt="" title="" />
                    <div class="user_details">
                        <p><span>${g_data.user_info.name}</span>学号：${g_data.user_info.sid}</p>
                    </div>
                    <!--<div class="user_avatar"><img src="images/avatar.jpg" alt="" title="" /></div>-->
                </div>
                <nav class="user-nav">
                    <ul>
                        <li> <a href="#" data-popup=".popup-rent-records" class="open-popup close-panel"><img
                                    src="images/icons/white/mybook.png" alt="" title="" /><span>借阅记录</span></a></li>
                        <li> <a href="#" data-popup=".popup-donation-records" class="open-popup close-panel"><img
                                    src="images/icons/white/history.png" alt="" title="" /><span>捐书记录</span></a></li>
                        <li> <a href="#" data-popup=".popup-personal-info" class="open-popup close-panel"><img
                                    src="images/icons/white/history.png" alt="" title="" /><span>修改个人信息</span></a></li>
                        <li v-on:click="logout"> <a href="#" class=""><img src="images/icons/white/love.png" alt=""
                                    title="" /><span>登出</span></a></li>
                    </ul>
                </nav>
            </div>
            <div v-else>
                <div class="user_thumb">
                    <img src="images/我的背景.jpg" alt="" title="" />
                    <div class="user_details">
                        <p><span>用户未登陆</span></p>
                    </div>
                    <!--<div class="user_avatar"><img src="images/avatar.jpg" alt="" title="" /></div>-->
                </div>
                <nav class="user-nav">
                    <ul>
                        <li> <a data-popup=".popup-login" class="open-popup close-panel" href="#"><img
                                    src="images/icons/white/love.png" alt="" title="" /><span>登录</span></a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>

    <div class="views">
        <!-- Your main view, should have "view-main" class -->
        <div class="view view-main">
            <div class="pages">
                <div data-page="index" class="page homepage">
                    <div class="navbarpages">
                        <div class="navbar_left">
                            <div class="logo_text"><a href="index.html">法学与艺术分馆</a></div>
                        </div>
                        <div class="navbar_right navbar_right_menu">
                            <a href="#" data-panel="left" class="open-panel"><img src="images/icons/white/menu.png"
                                    alt="" title="" />
<!--                                <span class="superscript03"><font style="vertical-align: inherit;">3</font></span>-->
                            </a>
                        </div>
                        <div class="navbar_right">
                            <a href="#" data-panel="right" class="open-panel"><img src="images/icons/white/user.png"
                                    alt="" title="" /></a>
                        </div>
                    </div>
                    <!-- Slider -->
                    <div class="swiper-container slidertoolbar swiper-init" data-effect="slide" data-parallax="true"
                        data-pagination=".swiper-pagination" data-next-button=".swiper-button-next"
                        data-prev-button=".swiper-button-prev">
                        <div class="swiper-wrapper">

                            <div class="swiper-slide" style="background-image:url(images/index01.jpg);">
                                <div class="slider_trans">
                                    <div class="slider-caption">
                                        <span class="subtitle" data-swiper-parallax="-60%">法学分馆与艺术分馆</span>
                                        <h2 data-swiper-parallax="-100%">欢迎来到法学与艺术捐书系统</h2>

                                        <p data-swiper-parallax="-30%">
                                            新用户请先登录<br />点击左上角的“法学与艺术分馆”即可返回首页<br />在这里，你可以更快捷的借到捐赠的图书，也可以将你喜欢的图书捐给我们与大家分享，谢谢您的支持！
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="swiper-slide" style="background-image:url(images/index02.jpg);">
                                <div class="slider_trans">
                                    <div class="slider-caption">
                                        <span class="subtitle" data-swiper-parallax="-60%">借书须知</span>
                                        <h2 data-swiper-parallax="-100%">扫一扫借书</h2>
                                        <p data-swiper-parallax="-30%">
                                            直接从图书馆扫一扫借书，快捷方便，无需消磁。<br />
<!--                                            2、从上一位同学手中直接借走，无需返还到图书馆再次借书，省时方便。<br />-->
<!--                                            3、转借同学一定要监督借走图书的同学扫一扫借书，否则在借人仍是自己。-->
                                        </p>

                                    </div>
                                </div>
                            </div>
                            <div class="swiper-slide" style="background-image:url(images/index03.jpg);">
                                <div class="slider_trans">
                                    <div class="slider-caption">
                                        <span class="subtitle" data-swiper-parallax="-60%">捐书须知</span>
                                        <h2 data-swiper-parallax="-100%">我要捐书</h2>

                                        <p data-swiper-parallax="-30%">有任何想要捐赠给图书馆的书籍，请按步骤完成捐赠。</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="swiper-pagination"></div>
                        <div class="swiper-button-prev"></div>
                        <div class="swiper-button-next"></div>
                    </div>

                    <div class="swiper-container-toolbar swiper-toolbar swiper-init" data-effect="slide"
                        data-slides-per-view="1" data-slides-per-group="1" data-space-between="0"
                        data-pagination=".swiper-pagination-toolbar">
                        <div class="swiper-pagination-toolbar"></div>
                        <div class="swiper-wrapper">
                            <div class="swiper-slide toolbar-icon">
                                <a href="borrow_book.html" data-view=".view-main"><img src="images/icons/green/扫一扫.png"
                                        alt="" title="" /><span>扫一扫借书</span></a>
                                <a href="books_list.html" data-view=".view-main"><img src="images/icons/green/list.png"
                                        alt="" title="" /><span>图书馆藏书</span></a>
                                <a href="books_donation.html" data-view=".view-main"><img src="images/icons/green/书.png"
                                        alt="" title="" /><span>我要捐书</span></a>
                                <a href="return-book.html" data-popup="" class="lose-panel"><img
                                        src="images/icons/green/相机.png" alt="" title="" /><span>拍照还书</span></a>
                                <a href="#" data-popup=".popup-loading" class="open-popup close-panel"><img
                                        src="images/icons/green/message.png" alt="" title="" />
<!--                                    <span class="superscript02"><font style="vertical-align: inherit;">3</font></span>-->
                                    <span>交流区</span></a>
                                <a v-if="g_data.isLogin" href="#" data-panel="right" class="open-panel"><img
                                        src="images/icons/green/lock.png" alt=""
                                        title="" /><span>${g_data.user_info.name}</span></a>
                                <a v-if="!g_data.isLogin" href="#" data-popup=".popup-login"
                                    class="open-popup close-panel"><img src="images/icons/green/lock.png" alt=""
                                        title="" /><span>登录</span></a>
                            </div>
                        </div>
                    </div>


                </div>
            </div>
        </div>



    </div>
    </div>


    <!-- Login Popup -->
    <div class="popup popup-login">
        <div class="content-block">
            <h4>登录</h4>
            <div class="loginform">
                <form id="LoginForm" method="post">
                    <input type="text" name="sid" value="" class="form_input required" placeholder="学号" />
                    <input type="password" name="pwd" value="" class="form_input required" placeholder="密码" />
                    <!--<div class="forgot_pass"><a href="#" data-popup=".popup-forgot" class="open-popup">Forgot Password?</a></div>-->
                    <input type="submit" name="submit" class="form_submit" id="submit" value="登录" />
                    <article>
                        <section class="description">
                            <p>本系统账号与 <a href="http://i.xmu.edu.cn">i.xmu.edu.cn</a>
                                上的用户名/密码一致。<br>如果密码输入错误<b>超过3次</b>，需要先前往 <a href="http://i.xmu.edu.cn">i.xmu.edu.cn</a>
                                上登陆。</p>
                        </section>
                    </article>
                </form> 
            </div>
            <div class="close_popup_button">
                <a href="#" class="close-popup"><img src="images/icons/black/menu_close.png" alt="" title="" /></a>
            </div>
        </div>
    </div>

    <!-- loading Popup -->
    <div class="popup popup-loading">
        <div class="content-block">
            <h4>待开发</h4>
            <div class="loginform">
                <label id="loader" style=""><img src="images/loader01.gif" alt="Loading..." id="LoadingGraphic"></label>
                <div class="signup_bottom">
                    <p>该功能正在开发中。</p>
                </div>
            </div>
            <div class="close_popup_button">
                <a href="#" class="close-popup"><img src="images/icons/black/menu_close.png" alt="" title="" /></a>
            </div>
        </div>
    </div>

    <!-- 正在处理提示窗 -->
    <div class="popup popup-pending" style="text-align:center;background-color: rgba(0,0,0,0.5);">
        <div class="content-block" style="padding:40% 5%"> 
            <label><img src="images/loader01.gif" alt="Loading..." ></label>
            <h4 style="color:white;margin:0 auto;" class="pendding-text">正在处理...</h4>
        </div>
    </div>

    <!-- 出错提示窗 -->
    <div class="popup popup-error close-popup"  style="text-align:center;background-color: rgba(0,0,0,0.5);">
            <div class="content-block" style="padding:30% 5%"> 
                <label><img src="images/error.png" style="width:20%;height:20%" alt="Loading..." ></label>
                <b><h2 style="color:red;margin:0 auto;font-weight: 900" class="error-text"></h2> </b>
                <div class="close_popup_button">
                    <a href="#" class="close-popup"><img src="images/icons/black/menu_close.png" alt="" title="" /></a>
                </div>
            </div>
    </div>

    <!-- 借阅记录 -->
    <div class="popup popup-rent-records" id="rent-records">
        <div class="content-block">
            <h2 class="page_title">我的借阅记录
                <span class="">(共${g_data.not_returned_books.length+g_data.returned_books.length}条记录，其中未还图书：${g_data.not_returned_books.length}本)</span>
            </h2>
            <div class="loginform">
                <ul class="shop_items">
                    <li v-for="book in g_data.not_returned_books">
                        <div style="width:15%" class="shop_thumb"><a href="#"><img v-bind:src="book.picture" alt=""
                                    title="" /></a></div>
                        <div style="width:80%;text-align: left" class="shop_item_details">
                            <div><b v-text="book.title"></b> <i v-text="`(${book.author})`">&nbsp;</i></div>
                            <div v-text="`${book.publisher} (${book.pubdate})`"></div>
                            <div>借书时间：${book.borrow_time}</div>
                            <div>还书时间：<a href="return-book.html" class="close-popup"><b style="color: red">未还(点击跳到还书界面)</b></a></div>
                        </div>
                    </li>
                    <li v-for="book in g_data.returned_books">
                        <div style="width:15%" class="shop_thumb"><a href="#"><img v-bind:src="book.picture" alt=""
                                    title="" /></a></div>
                        <div style="width:80%;text-align: left" class="shop_item_details">
                            <div><b v-text="book.title"></b> <i v-text="`(${book.author})`">&nbsp;</i></div>
                            <div v-text="`${book.publisher} (${book.pubdate})`"></div>
                            <div>借书时间：${book.borrow_time}</div>
                            <div>还书时间：<u><b v-on:click="showReturnImage(book.return_image_path)"
                                        style="color: green">${book.return_time}</b></u></div>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="close_popup_button">
                <a href="#" class="close-popup"><img src="images/icons/black/menu_close.png" alt="" title="" /></a>
            </div>
        </div>

    </div>
    <!-- 捐书记录 -->
    <div class="popup popup-donation-records">
        <div class="content-block">
            <h2 class="page_title">我的捐书列表
                <span class="">
                 (审核通过${g_data.donation_books.accepted.length}本，等待审核${g_data.donation_books.waiting.length}本)
                </span>
            </h2>
            <div class="loginform">
                <ul class="shop_items">

                    <li v-for="b in g_data.donation_books.waiting">
                        <div class="shop_thumb" style="width: 20%;"><a href="#"><img v-bind:src="b.picture" alt=""
                                    title="" /></a></div>
                        <div class="shop_item_details" style="width: 75%; text-align: left;">
                            <div><b>${b.title}</b> <i>(${b.author})</i></div>
                            <div>${b.publisher}&nbsp; (${b.pubdate})</div>
                            <div>提交时间：${b.time}</div>
                            <div>你的留言:
                                    <b v-if="b.donator_word!=''">${b.donator_word}</b>
                                    <b v-if="b.donator_word==''">你没有留下任何话~</b>
                            </div>
                            <div style="color:blue"><b>等待审核</b>></div>
                        </div>
                    </li>
                    <li v-for="b in g_data.donation_books.accepted">
                        <div class="shop_thumb" style="width: 20%;"><a href="#"><img v-bind:src="b.picture" alt=""
                                    title="" /></a></div>
                        <div class="shop_item_details" style="width: 75%; text-align: left;">
                            <div><b>${b.title}</b> <i>(${b.author})</i></div>
                            <div>${b.publisher}&nbsp; (${b.pubdate})</div>
                            <div>提交时间：${b.time}</div>
                            <div>你的留言:
                                    <b v-if="b.donator_word!=''">${b.donator_word}</b>
                                    <b v-if="b.donator_word==''">你没有留下任何话~</b>
                            </div>
                            <div style="color:green"><b>审核通过</b></div>
                        </div>
                    </li>
                    <li v-for="b in g_data.donation_books.rejected">
                        <div class="shop_thumb" style="width: 20%;"><a href="#"><img v-bind:src="b.picture" alt=""
                                    title="" /></a></div>
                        <div class="shop_item_details" style="width: 75%; text-align: left;">
                            <div><b>${b.title}</b> <i>(${b.author})</i></div>
                            <div>${b.publisher}&nbsp; (${b.pubdate})</div>
                            <div>提交时间：${b.time}</div>
                            <div>你的留言:
                                    <b v-if="b.donator_word!=''">${b.donator_word}</b>
                                    <b v-if="b.donator_word==''">你没有留下任何话~</b>
                            </div>
                            <div style="color:red"><b>审核未通过</b></div>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="close_popup_button">
                <a href="#" class="close-popup"><img src="images/icons/black/menu_close.png" alt="" title="" /></a>
            </div>
        </div>

    </div>
    <!-- 个人信息 -->
    <div class="popup popup-personal-info" v-if="g_data.isLogin">
        <div class="content-block">
            <h4>修改个人信息</h4>
            <div class="page_single layout_fullwidth_padding">
                <div class="contactform">
                <form class="" id="CustomForm" method="post" action="" novalidate="novalidate">  
                <div class="form_row">
                    <label>姓名</label>     
                    <input type="text" v-model="g_data.user_info.name" readonly="readonly"  class="form_input required"/>
                    <label>学号</label>     
                    <input type="text" v-model="g_data.user_info.sid"  readonly class="form_input required"/>
                    <label>学院</label>     
                    <input type="text" v-model="g_data.user_info.school" placeholder="如人文学院" class="form_input required"/>
                    <label>学位</label>     
                    <input type="text" v-model="g_data.user_info.degree" placeholder="如本科生、研究生、博士等" class="form_input required"/>
                    <label>年级</label>     
                    <input type="text" v-model="g_data.user_info.grade" placeholder="如2016级" class="form_input required"/>
                    <label>微信号</label>     
                    <input type="text" v-model="g_data.user_info.wechat_name" placeholder="请输入你的微信号" class="form_input required"/>
                    <label>手机号码</label>     
                    <input type="text" v-model="g_data.user_info.phone" placeholder="请输入你的手机号码" class="form_input required"/>
                        
                    <label>个性签名</label>
                    <textarea name="message" class="form_textarea" rows="" v-model="g_data.user_info.other" placeholder="用一句话描述你自己吧~" cols=""></textarea>
                </div>
                    
                <input type="submit" name="submit" class="form_submit" v-on:click="update_user_info" value="更新个人信息">
                </form>
                </div>  
                </div>
        </div>
        <div class="close_popup_button"><a href="#" class="close-popup"><img src="images/icons/black/menu_close.png" alt="" title=""></a></div>
    </div>

    <!-- 图书信息 -->
    <div class="popup popup-book-detail">
            <div id="pages_maincontent" class="">   
            <div v-if="g_data.cur_book_info!=null">
            <h2 class="page_title">${g_data.cur_book_info.title}</h2>
            <div class="page_single layout_fullwidth_padding">
                <div class="shop_item">
                    <div class="shop_thumb">
                    <a rel="gallery-3"  title="Photo title" class="swipebox">
                        <img v-bind:src="g_data.cur_book_info.picture" alt="" title="">
                    </a> 
                    </div>
                    <div class="shop_item_details">
                        
                    <div class="post_single">  
                        <span class=""><b>${g_data.cur_book_info.publisher}(${g_data.cur_book_info.pubdate})</b></span>
                        <span class=""> <b>${g_data.cur_book_info.author}</b></span>
                        <!-- <span class=""> <span class="like">&#10084;</span><b>收藏</b></span> -->
                        <span class="" style="float:right"> <b v-bind:style="`color:${g_data.cur_book_info.stock==g_data.cur_book_info.lended?'red':'green'}`" v-text="`可借:${g_data.cur_book_info.stock-g_data.cur_book_info.lended}/${g_data.cur_book_info.stock}本`"></b></span>
                    </div>
                    <p v-text="g_data.cur_book_info.summary"></p>
                    <!-- <p><strong>CATEGORY:</strong> <a href="shop.html">cars</a></p> -->

                    <div><span><b>藏书点藏书</b></span></div>
                    <ul class="responsive_table">
                            <li class="table_row">
                                <div class="table_section_2">藏书点</div> 
                                <div class="table_section">描述</div> 
                                <div class="table_section">当前可借</div> 
                            </li>
                            <li v-if="g_data.cur_book_stock_in_sites==null">
                                <div style="width: 100%;text-align: center;color:red" >正在获取各藏书点藏书信息...</div>
                            </li>
                            <li v-else class="table_row">
                                <div v-for="item in g_data.cur_book_stock_in_sites">
                                    <div class="table_section_2">${item.name}</div> 
                                    <div class="table_section">${item.description.substr(0,5)}</div> 
                                    <div class="table_section">${item.stock}本</div> 
                                </div>
                                <div v-if="g_data.cur_book_stock_in_sites.length==0"> 
                                        <div style="color:darkred;width:100%;text-align: center">馆中图书已经被借光了~可联系当前借阅的同学转借~</div> 
                                </div>
                            </li>
                    
                        </ul>

                    <div><span><b>捐书者信息</b></span></div>
                    <ul class="responsive_table">
                            <li class="table_row">
                                <div class="table_section_2">捐书日期</div> 
                                <div class="table_section">捐书者</div> 
                                <div class="table_section">捐书留言</div> 
                            </li>
                            <li v-if="g_data.cur_book_donators==null">
                                <div style="width: 100%;text-align: center;color:red" >正在载入捐书者信息...</div>
                            </li>
                            <li v-else class="table_row">
                                <div v-for="item in g_data.cur_book_donators">
                                    <div class="table_section_2">${item.donate_time}</div> 
                                    <div class="table_section">${item.name}</div> 
                                    <div class="table_section" v-text='item["捐书留言"]==``?`-`:item["捐书留言"]'></div> 
                                </div>
                            </li>
                    
                        </ul>
                        <div><span><b>当前借阅读者(可联系当前借阅同学转借)</b></span></div>
                    <ul class="responsive_table">
                            <li class="table_row">
                                <div class="table_section_2">借阅时间</div>
                                <div class="table_section">借阅读者</div>
                                <div class="table_section_2">联系方式</div>
                            </li>
                            <li v-if="g_data.cur_book_borrower==null">
                                <div style="width: 100%;text-align: center;color:red" >正在载入当前借阅读者...</div>
                            </li>
                            <li v-else class="table_row">
                                <div v-if="g_data.cur_book_borrower.length==0">
                                        <div style="width: 100%;text-align: center;color:red" >当前没人借走这本书~</div>
                                </div>
                                <div v-for="item in g_data.cur_book_borrower">
                                    <div class="table_section_2">${item.borrow_time}</div> 
                                    <div class="table_section">${item.name}</div> 
                                    <div class="table_section">${item.phone}</div> 
                                </div>
                            </li>
                    
                        </ul>
                    <!-- <a href="cart.html" class="button_full btyellow">ADD TO CART</a>  -->
                    </div> 
                </div> 
                </div> 
                </div>        
            </div>
            <div class="close_popup_button"><a href="#" class="close-popup"><img src="images/icons/black/menu_close.png" alt="" title=""></a></div>

        </div>

    <script src="js/vue.min.js"></script>
    <script type="text/javascript" src="js/jquery-1.10.1.min.js"></script>
    <script type="text/javascript" src="js/jquery.validate.min.js"></script>
    <script type="text/javascript" src="js/framework7.js"></script>
    <script type="text/javascript" src="js/jquery.swipebox.js"></script>
    <script type="text/javascript" src="js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="js/email.js"></script>
    <script type="text/javascript" src="js/audio.min.js"></script>
    <script type="text/javascript" src="js/my-app.js"></script>
    <script src="js/quagga.min.js" type="text/javascript"></script>
    <script src="js/utils.js" type="text/javascript"></script>
    <script src="js/qrscan.js" type="text/javascript"></script>

</body>

</html>